package sheet

import (
	"testing"
	"github.com/laidbackware/broadcom-portal-cve-collector/api"
	"github.com/stretchr/testify/assert"
)

func TestWriteSheet(t *testing.T) {

	testData := map[string][]api.Cve {
		"Tanzu": {
			{
				DocumentID: "test_DocumentID",
				Published: "test_Published",
				Status: "test_Status",
				Title: "test_Title",
				Updated: "test_Updated",
				NotificationURL: "test_NotificationURL",
				Severity: "test_Severity",
				SupportProducts: "test_SupportProducts",
				AffectedCve: "test_AffectedCve",
				WorkAround: "test_WorkAround",
			},
		},
		"VCF": {
			{
				DocumentID: "test_DocumentID",
				Published: "test_Published",
				Status: "test_Status",
				Title: "test_Title",
				Updated: "test_Updated",
				NotificationURL: "test_NotificationURL",
				Severity: "test_Severity",
				SupportProducts: "test_SupportProducts",
				AffectedCve: "test_AffectedCve",
				WorkAround: "test_WorkAround",
			},
		},
	}

	output_file, err := WriteSheet(testData, "")
	assert.Nil(t, err)
	assert.NotNil(t, output_file)

}